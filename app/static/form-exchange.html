<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario A: Registro de Intercambio - Maxocracia</title>
    <link rel="stylesheet" href="/static/css/vhv.css">
    <link rel="stylesheet" href="/static/css/forms.css">
</head>

<body>
    <div class="dashboard-main">
        <div class="forms-container">
            <!-- Hero Section -->
            <div class="forms-hero">
                <h1 class="forms-hero-title">ü§ù Registro de Intercambio</h1>
                <p class="forms-hero-subtitle">
                    Este formulario registra intercambios ya realizados para medir el flujo de la Red.
                </p>
            </div>

            <!-- Success Message -->
            <div id="successMessage" class="forms-success" style="display: none;">
                <div class="forms-success-icon">‚úÖ</div>
                <h2 class="forms-success-title">¬°Intercambio Registrado!</h2>
                <p class="forms-success-message" id="successDetails"></p>
                <button class="forms-btn forms-btn-primary" onclick="resetForm()" style="margin-top: 1rem;">
                    Registrar Otro Intercambio
                </button>
            </div>

            <!-- Error Message -->
            <div id="errorMessage" class="forms-error" style="display: none;">
                <span class="forms-error-icon">‚ö†Ô∏è</span>
                <span id="errorText"></span>
            </div>

            <!-- Form -->
            <form id="exchangeForm" class="forms-card">
                <!-- SECCI√ìN 1: Identificaci√≥n -->
                <div class="forms-section">
                    <h2 class="forms-section-title">
                        <span class="forms-emoji">üîñ</span>
                        SECCI√ìN 1: Identificaci√≥n
                    </h2>

                    <div class="forms-group">
                        <label class="forms-label forms-label-required" for="date">Fecha del Intercambio</label>
                        <input type="date" id="date" name="date" class="forms-input" required>
                    </div>

                    <div class="forms-group">
                        <label class="forms-label forms-label-required" for="interchange_id">C√≥digo / ID de
                            Intercambio</label>
                        <input type="text" id="interchange_id" name="interchange_id" class="forms-input"
                            placeholder="Ej: INT-001" maxlength="20" required>
                    </div>

                    <div class="forms-group">
                        <label class="forms-label forms-label-required" for="giver_search">¬øQui√©n DIO la ayuda?</label>
                        <div class="searchable-select">
                            <input type="text" id="giver_search" class="forms-input"
                                placeholder="Buscar participante..." autocomplete="off">
                            <input type="hidden" id="giver_id" name="giver_id" required>
                            <div id="giver_results" class="search-results-dropdown" style="display: none;"></div>
                            <div id="giver_badge" class="selected-badge" style="display: none;">
                                <span class="selected-badge-name"></span>
                                <span class="selected-badge-remove" onclick="clearSelection('giver')">√ó</span>
                            </div>
                        </div>
                    </div>

                    <div class="forms-group">
                        <label class="forms-label forms-label-required" for="receiver_search">¬øQui√©n RECIBI√ì la
                            ayuda?</label>
                        <div class="searchable-select">
                            <input type="text" id="receiver_search" class="forms-input"
                                placeholder="Buscar participante..." autocomplete="off">
                            <input type="hidden" id="receiver_id" name="receiver_id" required>
                            <div id="receiver_results" class="search-results-dropdown" style="display: none;"></div>
                            <div id="receiver_badge" class="selected-badge" style="display: none;">
                                <span class="selected-badge-name"></span>
                                <span class="selected-badge-remove" onclick="clearSelection('receiver')">√ó</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SECCI√ìN 2: Descripci√≥n -->
                <div class="forms-section">
                    <h2 class="forms-section-title">
                        <span class="forms-emoji">üì¶</span>
                        SECCI√ìN 2: ¬øQu√© se intercambi√≥?
                    </h2>

                    <div class="forms-group">
                        <label class="forms-label">Tipo de Intercambio</label>
                        <div class="forms-checkbox-group">
                            <div class="forms-checkbox-item">
                                <input type="checkbox" id="type_obj" name="type" value="objeto">
                                <label for="type_obj">üì¶ Objeto</label>
                            </div>
                            <div class="forms-checkbox-item">
                                <input type="checkbox" id="type_skill" name="type" value="habilidad">
                                <label for="type_skill">üõ† Habilidad / Servicio</label>
                            </div>
                            <div class="forms-checkbox-item">
                                <input type="checkbox" id="type_food" name="type" value="alimentacion">
                                <label for="type_food">üçΩ Alimentaci√≥n</label>
                            </div>
                            <div class="forms-checkbox-item">
                                <input type="checkbox" id="type_info" name="type" value="conocimiento">
                                <label for="type_info">üìö Conocimiento</label>
                            </div>
                        </div>
                    </div>

                    <div class="forms-group">
                        <label class="forms-label forms-label-required" for="description">Descripci√≥n del
                            intercambio</label>
                        <textarea id="description" name="description" class="forms-textarea"
                            placeholder="Ej: Pr√©stamo de escalera por 3 d√≠as" required></textarea>
                    </div>

                    <div class="forms-group">
                        <label class="forms-label forms-label-required">Urgencia de la necesidad atendida</label>
                        <div class="forms-radio-group">
                            <div class="forms-radio-item">
                                <input type="radio" id="urg_high" name="urgency" value="Alta" required>
                                <label for="urg_high">üî¥ Alta</label>
                            </div>
                            <div class="forms-radio-item">
                                <input type="radio" id="urg_med" name="urgency" value="Media">
                                <label for="urg_med">üü° Media</label>
                            </div>
                            <div class="forms-radio-item">
                                <input type="radio" id="urg_low" name="urgency" value="Baja">
                                <label for="urg_low">üü¢ Baja</label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SECCI√ìN 3: M√©tricas Maxocr√°ticas -->
                <div class="forms-section">
                    <h2 class="forms-section-title">
                        <span class="forms-emoji">‚è±Ô∏è</span>
                        SECCI√ìN 3: M√©tricas Maxocr√°ticas
                    </h2>

                    <div class="forms-group">
                        <label class="forms-label" for="uth_hours">Unidades de Talento Humano (Horas estimadas)</label>
                        <div class="vhv-input-group">
                            <input type="number" id="uth_hours" name="uth_hours" class="forms-input" step="0.5"
                                placeholder="0.0">
                            <span class="vhv-input-addon">h</span>
                        </div>
                    </div>

                    <div class="forms-group">
                        <label class="forms-label" for="economic_value">Valor Econ√≥mico Aproximado (Referencia en
                            Pesos)</label>
                        <input type="number" id="economic_value" name="economic_value" class="forms-input"
                            placeholder="$ 0">
                    </div>

                    <div class="forms-group">
                        <label class="forms-label" for="urf_description">Unidad de Recursos F√≠sicos (URF)</label>
                        <textarea id="urf_description" name="urf_description" class="forms-textarea"
                            placeholder="¬øQu√© recursos f√≠sicos se usaron? (gasolina, materiales, etc.)"></textarea>
                    </div>
                </div>

                <!-- SECCI√ìN 4: Impacto y Seguimiento -->
                <div class="forms-section">
                    <h2 class="forms-section-title">
                        <span class="forms-emoji">‚ú®</span>
                        SECCI√ìN 4: Impacto y Seguimiento
                    </h2>

                    <div class="forms-group">
                        <label class="forms-label forms-label-required">Grado de resoluci√≥n de la necesidad</label>
                        <div class="forms-radio-group">
                            <div class="forms-radio-item">
                                <input type="radio" id="res_5" name="impact_resolution_score" value="5" required>
                                <label for="res_5">5 - Completamente</label>
                            </div>
                            <div class="forms-radio-item">
                                <input type="radio" id="res_3" name="impact_resolution_score" value="3">
                                <label for="res_3">3 - Parcialmente</label>
                            </div>
                            <div class="forms-radio-item">
                                <input type="radio" id="res_1" name="impact_resolution_score" value="1">
                                <label for="res_1">1 - Poco o Nada</label>
                            </div>
                        </div>
                    </div>

                    <div class="forms-group">
                        <label class="forms-label forms-label-required">Estado de Reciprocidad</label>
                        <div class="forms-radio-group">
                            <div class="forms-radio-item">
                                <input type="radio" id="rec_done" name="reciprocity_status" value="Completada" required>
                                <label for="rec_done">üîÑ Completada (I-A)</label>
                            </div>
                            <div class="forms-radio-item">
                                <input type="radio" id="rec_pend" name="reciprocity_status" value="Pendiente">
                                <label for="rec_pend">‚è≥ Pendiente</label>
                            </div>
                            <div class="forms-radio-item">
                                <input type="radio" id="rec_none" name="reciprocity_status" value="Dato Puro">
                                <label for="rec_none">üéÅ Donativo / Gesto puro</label>
                            </div>
                        </div>
                    </div>

                    <div class="forms-group">
                        <label class="forms-label">Dimensi√≥n Humana Atendida</label>
                        <div class="forms-checkbox-group">
                            <div class="forms-checkbox-item">
                                <input type="checkbox" id="dim_food" name="human_dimension" value="alimentacion">
                                <label for="dim_food">Subsistencia</label>
                            </div>
                            <div class="forms-checkbox-item">
                                <input type="checkbox" id="dim_health" name="human_dimension" value="salud">
                                <label for="dim_health">Salud / Protecci√≥n</label>
                            </div>
                            <div class="forms-checkbox-item">
                                <input type="checkbox" id="dim_social" name="human_dimension" value="social">
                                <label for="dim_social">Conexi√≥n Social</label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SECCI√ìN 5: Log√≠stica y Notas -->
                <div class="forms-section">
                    <h2 class="forms-section-title">
                        <span class="forms-emoji">üìù</span>
                        SECCI√ìN 5: Log√≠stica y Notas
                    </h2>

                    <div class="forms-group">
                        <label class="forms-label forms-label-required">¬øC√≥mo se coordin√≥?</label>
                        <div class="forms-radio-group">
                            <div class="forms-radio-item">
                                <input type="radio" id="coord_wap" name="coordination_method" value="WhatsApp" required>
                                <label for="coord_wap">üì± WhatsApp</label>
                            </div>
                            <div class="forms-radio-item">
                                <input type="radio" id="coord_tel" name="coordination_method" value="Telegram">
                                <label for="coord_tel">‚úàÔ∏è Telegram</label>
                            </div>
                            <div class="forms-radio-item">
                                <input type="radio" id="coord_per" name="coordination_method" value="Presencial">
                                <label for="coord_per">üë§ Presencial</label>
                            </div>
                        </div>
                    </div>

                    <div class="forms-group">
                        <label class="forms-label forms-label-required">¬øRequiere seguimiento?</label>
                        <div class="forms-radio-group">
                            <div class="forms-radio-item">
                                <input type="radio" id="follow_yes" name="requires_followup" value="1" required>
                                <label for="follow_yes">S√≠</label>
                            </div>
                            <div class="forms-radio-item">
                                <input type="radio" id="follow_no" name="requires_followup" value="0">
                                <label for="follow_no">No</label>
                            </div>
                        </div>
                    </div>

                    <div class="forms-group">
                        <label class="forms-label" for="followup_date">Fecha sugerida de seguimiento</label>
                        <input type="date" id="followup_date" name="followup_scheduled_date" class="forms-input">
                    </div>

                    <div class="forms-group">
                        <label class="forms-label" for="facilitator_notes">Notas del Facilitador / Observaciones</label>
                        <textarea id="facilitator_notes" name="facilitator_notes" class="forms-textarea"></textarea>
                    </div>
                </div>

                <!-- Hidden Submit (Handled by Wizard) -->
                <button type="submit" id="submitBtn" style="display:none">Registrar Intercambio</button>
            </form>
        </div>
    </div>

    <script src="/static/js/api.js"></script>
    <script src="/static/js/ui-shell.js"></script>
    <script src="/static/js/ui-wizard.js"></script>
    <script src="/static/js/forms.js"></script>
    <script src="/static/js/form-exchange.js"></script>
</body>

</html>